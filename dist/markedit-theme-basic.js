"use strict";const wt=require("@codemirror/state"),t=require("@lezer/highlight"),C=require("markedit-api"),K=require("@codemirror/view"),v=require("@codemirror/language"),L=(e,s={})=>e??s,qt=L(C.MarkEdit.userSettings),U=mt("extension.markeditTheming"),Lt=q(!1)?L(U.lightTheme):void 0,Pt=q(!0)?L(U.darkTheme):void 0;function mt(e){return e===void 0?{}:L(qt[e])}function ut(e){return e.enabledMode??"both"}function q(e,s=ut(U)){return["both",e?"dark":"light"].includes(s)}function Et(e,s,c){const r=Dt({lhs:c,rhs:e?Pt:Lt});return{extensions:[...e?tt(r,{dark:!0}):tt(r),s].filter(o=>o!==void 0),colors:r}}function tt(e,s){const c={},r=[],a=e.editor,o=e.highlight;a?.textColor&&(c["&"]??={},c["&"].color=a?.textColor,c[".cm-activeLineGutter"]={backgroundColor:a?.textColor}),a?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=a?.backgroundColor),a?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:a?.activeLineBackground}),a?.caretColor&&(c[".cm-content"]={caretColor:a?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a?.caretColor}),a?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:a?.selectionBackground}),a?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:a?.matchingBracketBackground}),a?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=a?.gutterText),a?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=a?.gutterBackground,c[".cm-gutters"].border="none"),a?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=a?.foldPlaceholderText),a?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=a?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),a?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:a?.searchMatchBackground}),a?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:a?.selectionMatchBackground}),o?.heading&&r.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&r.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&r.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&r.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&r.push({tag:t.tags.quote,color:o?.quote}),o?.link&&r.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.divider&&r.push({tag:t.tags.contentSeparator,color:o?.divider}),o?.comment&&r.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&r.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&r.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&r.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&r.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&r.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&r.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&r.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&r.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&r.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&r.push({tag:t.tags.className,color:o?.class}),o?.macro&&r.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&r.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&r.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&r.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&r.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&r.push({tag:[t.tags.separator,t.tags.processingInstruction,t.tags.definition(t.tags.name)],color:o?.instruction}),o?.invalid&&r.push({tag:t.tags.invalid,color:o?.invalid});const g=[];return Object.keys(c).length>0&&g.push(K.EditorView.theme(c,s)),r.length>0&&g.push(v.syntaxHighlighting(v.HighlightStyle.define(r))),g}function Dt(e){return{editor:{...e.lhs?.editor,...e.rhs?.editor},highlight:{...e.lhs?.highlight,...e.rhs?.highlight},allowsFallback:e.rhs?.allowsFallback??e.lhs?.allowsFallback}}const n={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule"},_t=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${n.lineGutter} {}
${n.foldGutter} {}
${n.visibleSpace} {}
${n.matchingBracket} {}
${n.activeIndicator} {}
${n.accentColor} {}
${n.syntaxMarker} {}
${n.boldText} {}
${n.italicText} {}
${n.quoteText} {}
${n.dividerColor} {}
`,ht=window,Gt=ht.__extractStyleRules__??(e=>e.value?.rules),Ot=ht.__extractHighlightSpecs__??(e=>e.value?.specs);function Rt(e){const s=document.createElement("style");return s.textContent=e,document.head.appendChild(s),s}function jt(e){if(e.length===0)return[{},[]];const s=W(e);return[Object.fromEntries(s.flatMap(r=>{const a=Gt(r)?.join(`
`)??"";return Object.entries(Ft(a))})),s.flatMap(r=>Ot(r)??[])]}function p(e,s,c){return e.find(r=>!!(r.tag.toString().includes(s.toString())&&r.color!==void 0))?.color??c}function _(e,s,c){for(const[r,a]of Object.entries(e))if(r.includes(s)&&(c===void 0||!r.includes(c))){const o=a.background??a.backgroundColor;if(o!==void 0)return o}}function Ht(e){const s=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(s===null)return;const[c,r,a]=s.slice(1,4).map(Number);return`rgba(${c}, ${r}, ${a}, 0.6)`}function bt(e){const s=a=>a!==null&&typeof a=="object";if(!s(e))return!0;const c=Object.entries(e),r=a=>a!=null;for(const[,a]of c)if(s(a)){if(!bt(a))return!1}else if(r(a))return!1;return!0}function W(e){return Array.isArray(e)?e.flatMap(W):"extension"in e?W(e.extension):[e]}function Ft(e){const s={},c=new CSSStyleSheet;c.replaceSync(e);for(const r of c.cssRules){const{style:a,selectorText:o}=r,{background:g,backgroundColor:u}=a;s[o]={},g.length>0&&(s[o].background=g),u.length>0&&(s[o].backgroundColor=u)}return s}function It(e){const s=e.options?.settingsKey,c=ut(mt(s));e.light!==void 0&&q(!1,c)&&(l().customThemes.light=e.light),e.dark!==void 0&&q(!0,c)&&(l().customThemes.dark=e.dark),typeof C.MarkEdit.editorView=="object"&&A(C.MarkEdit.editorView)}const w=window,l=()=>w.__markeditTheming__,ft=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&Wt();function Wt(){w.__markeditTheming__={styleSheet:Rt(_t),configurator:new wt.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},C.MarkEdit.addExtension(l().configurator.of([])),C.MarkEdit.onEditorReady(s=>A(s));const e=()=>setTimeout(()=>A(C.MarkEdit.editorView),15);ft.addEventListener("change",e),l().mainThemeName=w.config.theme,Object.defineProperty(w.config,"theme",{get(){return l().mainThemeName},set(s){l().mainThemeName=s,e()}})}function A(e){const s=ft.matches,c=s?l().customThemes.dark:l().customThemes.light,{extensions:r,colors:a}=Et(s,c?.extension,c?.colors);e.dispatch({effects:l().configurator.reconfigure(r)});const[o,g]=jt(r),u=r.length===0&&bt(a),T=a.allowsFallback??c?.extension!==void 0;l().styleSheet.disabled=u,At(e,s,u,o,g,a,T)}function At(e,s,c,r,a,o,g){const u=_(r,".cm-activeLine",".cm-activeLineGutter"),T=_(r,n.selectionBackground),Ct=_(r,n.matchingBracket),P=getComputedStyle(e.contentDOM).color,Q=o.editor?.visibleSpaceColor??Ht(P),f=g?P:void 0,X=p(a,t.tags.heading,f),vt=p(a,t.tags.processingInstruction,f),yt=p(a,t.tags.strong,f),xt=p(a,t.tags.emphasis,f),Bt=p(a,t.tags.quote,f),Tt=p(a,t.tags.contentSeparator,f),$t=[[n.activeIndicator,u,"background"],[n.matchingBracket,Ct,"background"],[n.lineGutter,P,"color"],[n.foldGutter,Q,"color"],[n.visibleSpace,Q,"color"],[n.accentColor,X,"color"],[n.syntaxMarker,vt,"color"],[n.boldText,yt,"color"],[n.italicText,xt,"color"],[n.quoteText,Bt,"color"],[n.dividerColor,Tt,"color"]],Mt=Array.from(document.querySelectorAll("style")),$=s?l().darkOriginalRules:l().lightOriginalRules;for(const St of Mt){const E=St.sheet?.cssRules;if(E!==void 0)for(let D=0;D<E.length;++D){const d=E[D],h=d.selectorText??"";h.includes(".cm-focused")&&h.includes(n.selectionBackground)&&($.selectionBackground??=d.cssText,c?d.cssText=$.selectionBackground:T!==void 0&&d.style.setProperty("background",T,"important")),X!==void 0&&(h===".cm-md-header"||h===".cm-md-header:not(.cm-md-quote)")&&($.markdownHeader??=d.cssText,c?d.cssText=$.markdownHeader:d.style.removeProperty("color"));for(const[Nt,Y,Z]of $t)h===Nt&&(Y===void 0?d.style.removeProperty(Z):(d.style.setProperty(Z,Y,"important"),(h===n.matchingBracket||h===n.activeIndicator)&&d.style.setProperty("box-shadow","unset","important")))}}}const ot="#2e3440",z="#3b4252",et="#434c5e",M="#4c566a",at="#e5e9f0",V="#eceff4",G="#8fbcbb",rt="#88c0d0",Vt="#81a1c1",i="#5e81ac",Kt="#bf616a",k="#d08770",O="#ebcb8b",ct="#a3be8c",Ut="#b48ead",st="#d30102",J=V,R=J,zt="#ffffff",j=z,Jt=J,nt=z,Qt=K.EditorView.theme({"&":{color:ot,backgroundColor:zt},".cm-content":{caretColor:nt},".cm-cursor, .cm-dropCursor":{borderLeftColor:nt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Jt},".cm-panels":{backgroundColor:J,color:M},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:`1px solid ${M}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:at},".cm-activeLine":{backgroundColor:R},".cm-selectionMatch":{backgroundColor:at},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${M}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:V},".cm-gutters":{backgroundColor:V,color:ot,border:"none"},".cm-activeLineGutter":{backgroundColor:R},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:j},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:j,borderBottomColor:j},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:R,color:M}}},{dark:!1}),Xt=v.HighlightStyle.define([{tag:t.tags.keyword,color:i},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:k},{tag:[t.tags.variableName],color:k},{tag:[t.tags.function(t.tags.variableName)],color:i},{tag:[t.tags.labelName],color:Vt},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:i},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:ct},{tag:[t.tags.brace],color:G},{tag:[t.tags.annotation],color:st},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:rt},{tag:[t.tags.typeName,t.tags.className],color:O},{tag:[t.tags.operator,t.tags.operatorKeyword],color:ct},{tag:[t.tags.tagName],color:Ut},{tag:[t.tags.squareBracket],color:Kt},{tag:[t.tags.angleBracket],color:k},{tag:[t.tags.attributeName],color:O},{tag:[t.tags.regexp],color:i},{tag:[t.tags.quote],color:z},{tag:[t.tags.string],color:k},{tag:t.tags.link,color:G,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:k},{tag:[t.tags.meta],color:rt},{tag:[t.tags.comment],color:et,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:i},{tag:t.tags.emphasis,fontStyle:"italic",color:i},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:i},{tag:t.tags.special(t.tags.heading1),fontWeight:"bold",color:i},{tag:t.tags.heading1,fontWeight:"bold",color:i},{tag:[t.tags.heading2,t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:i},{tag:[t.tags.heading5,t.tags.heading6],color:i},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:k},{tag:[t.tags.processingInstruction,t.tags.inserted],color:G},{tag:[t.tags.contentSeparator],color:O},{tag:t.tags.invalid,color:et,borderBottom:`1px dotted ${st}`}]),Yt=[Qt,v.syntaxHighlighting(Xt)],Zt="#2E3235",m="#DDDDDD",B="#B9D2FF",S="#b0b0b0",to="#e0e0e0",pt="#808080",H="#000000",oo="#A54543",kt="#fc6d24",b="#fda331",F="#8abeb7",lt="#b5bd68",y="#6fb3d2",x="#cc99cc",eo="#6987AF",it=kt,gt="#292d30",N=B+"30",ao=Zt,I=m,ro="#202325",dt=m,co=K.EditorView.theme({"&":{color:m,backgroundColor:ao},".cm-content":{caretColor:dt},".cm-cursor, .cm-dropCursor":{borderLeftColor:dt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ro},".cm-panels":{backgroundColor:gt,color:S},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:B,outline:`1px solid ${S}`,color:H},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:to,color:H},".cm-activeLine":{backgroundColor:N},".cm-selectionMatch":{backgroundColor:N},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${S}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:B,color:H},".cm-gutters":{borderRight:"1px solid #ffffff10",color:pt,backgroundColor:gt},".cm-activeLineGutter":{backgroundColor:N},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:B},".cm-tooltip":{border:"none",backgroundColor:I},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:I,borderBottomColor:I},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:N,color:S}}},{dark:!0}),so=v.HighlightStyle.define([{tag:t.tags.keyword,color:b},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:lt},{tag:[t.tags.variableName],color:y},{tag:[t.tags.function(t.tags.variableName)],color:b},{tag:[t.tags.labelName],color:kt},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:b},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:x},{tag:[t.tags.brace],color:x},{tag:[t.tags.annotation],color:it},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:b},{tag:[t.tags.typeName,t.tags.className],color:y},{tag:[t.tags.operator,t.tags.operatorKeyword],color:x},{tag:[t.tags.tagName],color:b},{tag:[t.tags.squareBracket],color:x},{tag:[t.tags.angleBracket],color:x},{tag:[t.tags.attributeName],color:y},{tag:[t.tags.regexp],color:b},{tag:[t.tags.quote],color:m},{tag:[t.tags.string],color:lt},{tag:t.tags.link,color:eo,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:F},{tag:[t.tags.meta],color:oo},{tag:[t.tags.comment],color:pt,fontStyle:"italic"},{tag:t.tags.monospace,color:m},{tag:t.tags.strong,fontWeight:"bold",color:b},{tag:t.tags.emphasis,fontStyle:"italic",color:y},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:m},{tag:t.tags.special(t.tags.heading1),fontWeight:"bold",color:m},{tag:t.tags.heading1,fontWeight:"bold",color:m},{tag:[t.tags.heading2,t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:m},{tag:[t.tags.heading5,t.tags.heading6],color:m},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:F},{tag:[t.tags.processingInstruction,t.tags.inserted],color:F},{tag:[t.tags.contentSeparator],color:y},{tag:t.tags.invalid,color:B,borderBottom:`1px dotted ${it}`}]),no=[co,v.syntaxHighlighting(so)];It({light:{extension:Yt},dark:{extension:no},options:{settingsKey:"extension.markeditThemeBasic"}});
